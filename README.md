# yasukari
yasukari公式ホームページリニューアル

## 変更履歴

バージョンは0.1から開始し、軽微な修正は0.01刻み、主な修正では0.1刻みで更新します。開発中のため先頭に0を付けた表記です。

### v0.50
- Next.js による初期構築
- トップページのUI/UX設計・開発
- BikeModelCarousel コンポーネント追加
- Footer コンポーネント追加
- グローバルスタイルとアニメーションを導入

### v0.51
- ChatBotWidget 追加でどのページからでもチャットを起動可能に
- ManualページにCalendarWidgetとDirectoryTreeを表示
- ホーム画面をモダンなレイアウトへ刷新
- 商品一覧ページ(仮)を追加
- スタイル調整とリファクタリング

### v0.52
- **システムエンジニア・管理者専用サイト更新ブログ**に10件ずつのページネーションを実装
- DirectoryTreeを折りたたみ式にし各ファイルへのリンクを追加
- ソース閲覧用ページ `/source/*` を追加しテキスト表示に対応

### v0.53
- 簡易的なログイン機能を追加
- `/login` ページと `/api/login` API でユーザー認証を実装

### v0.54
- 新着情報ページ `/news` と 店舗ブログ `/customer_blog` を追加
- ホームにヒーロー画像スライダーを導入
- ヘルプページ `/help` を追加しナビゲーションからアクセス可能に
- 排気量などで絞り込めるジャンル別ページ `/t/genre/*` を追加
- 店舗一覧 `/stores` を掲載し料金 `/pricing`、保険説明 `/insurance` を新設
- ご利用案内 `/guide` と お問い合わせ `/contact` を整備
- 会社概要や外部送信規律、特商法、利用規約、プライバシーポリシーなど法定ページを追加

### v0.55
- トップページにFAQセクションを追加

### v0.56
- CSSスタイルガイドを追加しデザイン指針を共有
- 最近チェックした商品機能を実装
- アクセス集中時に一時ブロックする制限機能を導入
- サイトリニューアルのお知らせを公開

### v0.57
- 人気の型番カルーセルのデザインをモダンに刷新

### v0.58
- 店舗ブログにカレンダーとタグ別ページを追加し、マニュアルブログと同じレイアウトに統一
- ホームセクションの構成を整理しレイアウトを改善
- FAQセクションをランダム10件表示に変更
- はじめてガイドバナーのサイズを調整
- 最近チェックした商品画像を正方形に統一
- **カスタマーブログ記事**にハッシュタグを表示

### v0.59
- 注目キーワードを最大7件表示し、最後に「もっと見る」リンクを追加
- "原付スクーター" など8種類のキーワードをブログのハッシュタグへ紐付け


## manual_for_system
サイトの更新情報や運用マニュアルをMarkdown形式で記録するディレクトリです。`/manual_for_system` 配下の `.md` ファイルはサイト上でも閲覧できます。


## ディレクトリ構成
本リポジトリの主なディレクトリは以下の通りです。

```
components/         React コンポーネント群
pages/              画面を構成する Next.js ページ
manual_for_system/  運用マニュアル・更新ブログ
blog_for_custmor/   店舗向けブログ記事
lib/                便利関数やユーティリティ
styles/             グローバル CSS
data/               静的データファイル
docs/               プロジェクトドキュメント
```

より詳しい説明は [docs/OVERVIEW.md](docs/OVERVIEW.md) を参照してください。
## 各ファイルの役割

- `components/BikeModelCarousel.tsx`  
  トップページなどでバイクの人気モデルを横スクロール表示するカルーセルコンポーネント。型定義したBikeItem配列を受け取り、画像とモデル名、バッジをカード形式で表示します。Swiperライブラリを使いスマホではスワイプ操作可能。リンク遷移やタイトル変更にも対応し、220pxの画像を統一、セクションに余白と影を付けたデザインです。初期表示ではフェードイン効果を設定でき、ユーザーに注目してもらいやすいUIです。
- `components/ChatBot.tsx`  
  FAQデータを基にカテゴリ選択と質問応答を行うReactコンポーネント。useStateで会話履歴とステップを管理し、回答が見つからない場合は自由入力モードに移行します。Tailwind CSSでUIを調整し、吹き出し形式で履歴をスクロール表示。将来のOpenAI連携を想定した仮の返答を返し、シンプルなカードUIでスマホ対応。チャット部分は独立して再利用も容易です。
- `components/DirectoryTree.tsx`
  ディレクトリの構造をリスト形式で表示するコンポーネント。manual_for_systemページのサイドバーで利用します。
- `components/CalendarWidget.tsx`
  現在月のカレンダーを表示する小さなウィジェットです。
- `components/ChatBotWidget.tsx`
  画面右下に固定表示されるボタンからChatBotを開閉するウィジェットです。

- `components/FaqAccordion.tsx`
  質問と回答をアコーディオン形式で表示するコンポーネント。FAQセクションで利用します。
- `components/Header.tsx`
  サイト共通のヘッダー。検索バーとナビゲーション、メニューの開閉を提供します。
- `components/HeroSlider.tsx`
  トップページで大きな画像を自動スライド表示するヒーロースライダーです。
- `components/HowToUse.tsx`
  予約から返却までの流れを3ステップで案内するセクション用コンポーネント。
- `components/MobileNav.tsx`
  スマホ向けの固定ボトムナビゲーション。ホームやレンタル状況、マイページへ素早く移動できます。
- `components/RecentlyViewed.tsx`
  最近閲覧した車両をlocalStorageから取得して一覧表示するウィジェット。

- `components/Footer.tsx`  
  ページ下部に配置するフッターコンポーネント。ブランド説明文、サイトポリシーやサービス案内、SNSリンクを3カラムで整え、ロゴとコピーライトも表示します。Tailwind CSSのグリッドとLink、react-iconsを利用してレスポンシブ対応。薄グレーの背景と区切り線でページの締めを演出し、各項目は余白を活かしスマホでは縦並びに変化します。紹介文の下に問い合わせリンクを置き、ブランドの安心感を伝えます。
- `pages/index.tsx`
  ホーム画面を構成するメインページ。トップバーでキャンペーンを告知し、ヘッダーには検索バーとナビゲーションを設置。背景画像を使ったヒーローセクションや特徴紹介グリッド、新着ブログカルーセル、ジャンル別アイテム、人気モデルカルーセルを順に配置したモダンなレイアウトです。Swiperによるスライド表示とアニメーションを活用し、BikeModelCarouselやFooterコンポーネントを再利用しています.
- `pages/chat.tsx`
  チャットサポート専用のページ。Headでタイトルを設定し、メイン領域にChatBotコンポーネントを配置するだけのシンプルな構成です。背景を薄いグレーにし中央に見出しを置くことで、ユーザーがFAQ検索を始めやすい雰囲気を作ります。将来的な履歴保存や認証との連携も想定され、アプリ内のサブページとして扱いやすく独自スタイルも追加可能です。
- `pages/login.tsx`
  ユーザー名とパスワードでログインする簡易フォームを提供します。成功時はトップページへ遷移します。
- `pages/wait.tsx`
  アクセス集中時に一時的な待機を促すページで、解除ボタンで制限を解除できます.
- `pages/_app.tsx`
  全ページ共通の設定をまとめ、グローバルCSSやChatBotWidgetを読み込みます。レイアウト拡張や状態管理の導入ポイントとなります.
- `pages/_document.tsx`  
  HTMLのテンプレートを定義するNext.jsのDocumentファイル。Headでは外部のアイコンフォントやスタイルシート、アニメーションライブラリを読み込み、body内でMainとNextScriptを配置します。ここで追加したリンクやスクリプトは全ページに一括適用され、SEO対策や外部ツール設定をまとめて管理するのに便利です。アプリ全体の共通HTML構造を担う重要なファイルで、他の設定もここで統一します。
- `pages/products/index.tsx`
  全てのバイク機種を一覧表示するためのページ。現在は準備中のメッセージのみ表示します。

- `pages/manual_for_system/index.tsx`  
  **システムエンジニア・管理者専用サイト更新ブログ**の一覧を生成するファイル。manual_for_systemディレクトリ内のMarkdownを読み込み、日付順に並べ替えて一覧ページを静的生成します。タイトルや抜粋を取得し、リンクをクリックすると詳細ページへ遷移。シンプルなカードデザインで更新日と要約を表示し、サイトの運用状況を把握できます。getStaticPropsを活用することでビルド時にデータを取り込み、表示速度が速い点も特徴です。
- `pages/manual_for_system/[slug].tsx`  
  MarkdownファイルをHTMLに変換して表示する個別記事ページ。getStaticPathsでパスを生成し、getStaticPropsで内容を読み込みrenderMarkdown関数でタグに変換します。各記事は静的にビルドされ、ロードが速くSEOにも有利。コンテンツの更新時は再ビルドするだけで反映されます。表示はシンプルなプロース拡張クラスを使い、スタイルを保ちながら安全にHTMLを埋め込んでいます。
- `styles/global.css`  
  全体の配色やフォントを定めるグローバルCSS。:rootにカラーバリエーションを設定し、テキスト、リンク、ボタン、カードなどの共通デザインを定義しています。余白やホバーアニメーションも組み込み、_app.tsxで読み込むことで全ページにスタイルを適用。今後の追加ページでも基本となるスタイル群です。カード内画像の幅やボタンの丸みまで統一し、デザインの再利用性を高めます。今後のブランドカラー変更にも対応可能です。
- `data/faq.json`
  チャットボットで利用するFAQデータをJSON形式で管理。カテゴリごとにid、title、qaの配列を保持し、ChatBotコンポーネントから読み込まれて各質問の回答を返すための基礎情報となります。現在は静的ファイルとして簡易テスト用に置かれていますが、管理画面を用意すれば動的更新も可能な設計です。質問内容や回答文を増やすことでチャットボットの精度向上にもつながります。
- `data/bikes.json`
  バイクラインナップを一覧管理するJSONファイル。モデル名や画像に加えスペックや取扱店舗を記述しており、`lib/bikes.ts` から読み込まれます。将来的にデータベースへ移行する際のベースデータとして利用します。
- `lib/getDirTree.ts`
  指定パスからディレクトリ階層を取得するユーティリティ。DirectoryTreeコンポーネントから呼び出されます。
- `lib/bikes.ts`
  `data/bikes.json` を読み込んでバイクモデル一覧を返すユーティリティ。将来は DynamoDB などへの置き換えを想定しています。
- `lib/rateLimit.ts`
  APIやミドルウェアで使用する簡易メモリベースのレートリミッターを実装しています。
- `middleware.ts`
  IPごとのアクセス制御とmanual_for_systemディレクトリへのBasic認証を行うミドルウェアです。
- `manual_for_system/2025-06-30-site-update.md`  
  サイトの更新履歴を記録したMarkdownファイル。2025年6月30日時点の開発状況として、Next.js初期構築やトップページのカルーセル実装などを説明しています。Markdown形式のため履歴の閲覧や管理が容易で、プロジェクト初期の方針を振り返る資料としても役立ちます。今後の開発予定を追記していくことで進捗を追うドキュメントとしても利用され、履歴の共有でチーム全体の認識を統一します。
- `manual_for_system/2025-06-30-chatbot-design.md`
  チャットボット機能の設計メモをまとめたMarkdown。FAQカテゴリのボタン表示から自由入力へ遷移する流れやOpenAI API連携予定などを記述しています。試験実装時の注意点やデータファイルの配置場所も記録し、ブログ記事として公開することで社内外への進捗共有を兼ねます。開発意図を簡潔にメモして方針のブレを防ぐ役割を担い、今後のチャット機能拡張時に参照する基礎資料として残しています。
- `manual_for_system/2025-06-30-development-summary.md`
  開発状況のまとめを記したMarkdownファイルです。
- `manual_for_system/2025-06-30-search-suggest.md`
  サイト内検索のサジェスト機能検討メモです。
- `manual_for_system/2025-07-01-site-renewal.md`
  サイトリニューアルのお知らせを掲載したMarkdownファイル。2025年7月1日に更新し、旧サイトから順次移行する旨を告知しています。
- `manual_for_system/2025-07-01-css-style-guide.md`
  CSSスタイルガイドをまとめたドキュメントです。
- `manual_for_system/2025-07-01-ddos-protection.md`
  DDoS対策の方針を記したメモです。
- `manual_for_system/2025-07-01-development-summary.md`
  2025年7月1日時点の開発サマリをまとめています。
- `manual_for_system/2025-07-01-recently-viewed.md`
  最近チェックした商品機能についての設計ノートです。
- `manual_for_system/2025-07-02-development-summary.md`
  2025年7月2日の開発状況をまとめた記事です。
- `manual_for_system/2025-07-03-development-summary.md`
  2025年7月3日の開発状況をまとめた記事です。
- `blog_for_custmor/`
  店舗ブログ記事をMarkdownで管理するディレクトリです。各記事のフロントマターでは
  `title`, `date`, `tags` に加え `eyecatch`(アイキャッチ画像URL) を設定できます。
- `next.config.js`
  Next.jsの動作設定を記述するファイル。現状はreactStrictModeをfalseにした最小構成のみですが、今後画像ドメインの許可や環境変数の定義など、ビルドやランタイムの挙動を調整する際に利用します。
- `next-env.d.ts`  
  TypeScript用の宣言ファイルで、Next.jsが生成する型定義をまとめています。CSSモジュールの型やNext.js特有のグローバル型を含み、エディタの補完精度を高めます。通常は自動更新されますが、新しいファイル形式を追加した際は追記することで型エラーを防げます。プロジェクトの設定次第ではカスタムモジュール宣言も追記でき、型安全な開発を支える裏方的な存在です。変更時は再起動が必要です。
- `package.json`  
  プロジェクト管理に使用する設定ファイル。Next.jsやReact、Swiper、react-iconsなど依存ライブラリのバージョンを記述し、npm scriptsとしてdev・build・startコマンドを登録しています。プライベートフラグによりnpm公開はされず、今後依存追加やバージョン更新を行う際はここを編集しチームの環境を統一します。設定内容はGitで管理されているため、全員が同じ環境で作業できます。
- `tsconfig.json`  
  TypeScriptのコンパイル設定をまとめるファイル。ES2017ターゲットやモジュール解決方法、jsx設定などを定義し、strictモードは無効化。Next.js推奨のオプションをベースにインクリメンタルビルドやJSONモジュール読み込みを有効にしています。include/excludeを指定してnode_modulesを除外し、開発効率とビルド速度を向上させます。設定変更で型チェック厳格化も可能。
## AWS連携例
ログイン機能を本番運用する場合、Amazon Cognito を使って認証やユーザープールを管理することができます。EC2 上のアプリから Cognito を利用すれば、パスワードリセットや多要素認証なども簡単に設定できます。

## 開発環境のセットアップ
1. Node.js 18系を推奨します。リポジトリをクローン後、依存パッケージをインストールします。
   ```bash
   npm install
   ```
2. 開発サーバーを起動するには以下を実行します。
   ```bash
   npm run dev
   ```
   ブラウザで `http://localhost:3000` を開くとアプリを確認できます。
